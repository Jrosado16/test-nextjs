// Usuario 1 

// PASO 1
// que necesito
let amount = 10 // action - borrow - repay
let deudaDelegador = 0 // delegador
let deudaDelegado = 0 // delados
let interest = 0;

proportion = 0

if (deudaDelegado === 0)
	propotion = 0

deudaDelegador = 10
deudaDelegado = 10 + interest;

// PASO 2

amount = 10 // action - borrow - repay
deudaDelegador = 10.1 // delegador
deudaDelegado = 10 // delados
interest = 0 // ?

// calculo de interest de la deuda del delegador

interest_delegador = deudaDelegador(on-chain) - deudaDelegador(off-chain)
interest_delegador = 10.1 - 10.0;
interest_delegador = 0.1;

// la deuda del delgador pasa a ser la que viene on chain
deudaDelegador(off-chain) = deudaDelegador(on-chain);
deudaDelegador(off-chain) = 10.1;

// antes de calcular la proporcion calcular los intereses en base a la proporcion
interest_delegado = interest_delegador * propottion;
interest_delegado = 0.1 * 1;
interest_delegado = 0.1;

deudaDelegado += interest_delegado;
deudaDelegado = 10.1;

proportion = deudaDelegado +- amount / deudaDelegador(on-chain) +- amount
proportion = 10.1 +- 10 / 10.1 +- 10
proportion = 1

deudaDelegador = 20.1 // delegador


// =========================
// Usuario 2
// =========================


amount = 10 // action - borrow - repay
deudaDelegador = 20.12 // delegador - on-chain
deudaDelegado = 0 // delados
interest = 0 // ?

// ====== PROPORCION ====== 
if (deudaDelegado === 0)
	propotion = 0

interest_delegado = propotion === 0 ? 0 : // calculo de proporcion

// la deuda del delgador pasa a ser la que viene on chain
deudaDelegador(off-chain) = deudaDelegador(on-chain);
deudaDelegador(off-chain) = 20.12;

// Usuario 1
interest_delegado = interest_delegador * propotion;
interest_delegado = 0.12 * 1;
interest_delegado = 0.12;

// ====== PROPORCION ====== 
// usuario 2
deudaDelegado = 10
proportion = deudaDelegado +- amount / deudaDelegador(on-chain) +- amount
proportion = 0 + 10 / 20.12 + 10
proportion = 10 / 30.12
proportion = 0.332005312

// calculo de interes usairio = cero

// usuario 1
proportion = deudaDelegado +- amount / deudaDelegador(on-chain) +- amount
proportion = 20.12  / 30.12
proportion = 0.667994688


// ========================================================================
interest_delegador = deudaDelegador(on-chain) - deudaDelegador(off-chain)
interest_delegador = 30.12;
interest_delegador = 0.12;

interest_delegado = interest_delegador * proportion;
interest_delegado = 0.12 * 0.667994688;
interest_delegado = 0.12 + 0.12 * 0.667994688;
interest_delegado = 0.12080159363;


// PASO 2

amount = 10 // action - borrow - repay
deudaDelegador = 30.13 // delegador - on-chain
deudaDelegado = 10 // delados
interest = 0 // ?

proportion = deudaDelegado +- amount / deudaDelegador(on-chain) +- amount
proportion = 10.1 +- 10 / 10.1 +- 10
proportion = 1
// antes de calcular la proporcion calcular los intereses en base a la proporcion
interest_delegado = interest_delegador * propottion;
interest_delegado = 0.1 * 1;
interest_delegado = 0.1;

proportion = deudaDelegado +- amount / deudaDelegador(on-chain) +- amount
proportion = 0 +- 20 / 10.12 +- 10
proportion = 1

interest_delegador = deudaDelegador(on-chain) - deudaDelegador(off-chain)
interest_delegador = 10.12 - 10.1;
interest_delegador = 0.12;
